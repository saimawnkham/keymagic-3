import { Colors } from "../theme/colors.slint";
import { Fonts } from "../theme/fonts.slint";
import { Styles } from "../theme/styles.slint";

export component KeyboardCard inherits TouchArea {
    in property <string> keyboard-id;
    in property <string> name;
    in property <string> description;
    in property <string> hotkey;
    in property <bool> active;
    in property <bool> is-enabled;
    in property <bool> has-icon;
    in property <image> icon;
    in property <bool> selected;
    
    callback activate-requested();
    callback configure-requested();
    
    min-height: 100px;
    
    states [
        hover when self.has-hover && !self.pressed: {
            card.background: Colors.surface;
            card.drop-shadow-offset-y: 4px;
            card.drop-shadow-blur: 8px;
        }
        pressed when self.pressed: {
            card.background: Colors.surface;
            card.drop-shadow-offset-y: 1px;
            card.drop-shadow-blur: 2px;
        }
        selected when self.selected: {
            card.border-width: 2px;
            card.border-color: Colors.primary;
        }
    ]
    
    card := Rectangle {
        background: Colors.surface;
        border-radius: Styles.radius-lg;
        border-width: root.selected ? 2px : 1px;
        border-color: root.selected ? Colors.primary : Colors.border;
        drop-shadow-color: Colors.shadow;
        drop-shadow-offset-y: 2px;
        drop-shadow-blur: 4px;
        
        animate background { duration: Styles.transition-fast; }
        animate drop-shadow-offset-y { duration: Styles.transition-fast; }
        animate drop-shadow-blur { duration: Styles.transition-fast; }
        animate border-width { duration: Styles.transition-fast; }
        animate border-color { duration: Styles.transition-fast; }
        
        HorizontalLayout {
            padding: Styles.spacing-md;
            spacing: Styles.spacing-md;
            
            // Icon area
            Rectangle {
                width: 64px;
                background: Colors.background;
                border-radius: Styles.radius-md;
                
                if root.has-icon: Image {
                    source: root.icon;
                    width: 48px;
                    height: 48px;
                    image-fit: contain;
                }
                
                if !root.has-icon: Text {
                    text: "âŒ¨";
                    font-size: 32px;
                    color: Colors.text-secondary;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
            
            // Content area
            VerticalLayout {
                spacing: Styles.spacing-xs;
                alignment: start;
                horizontal-stretch: 1;
                
                // Title row
                HorizontalLayout {
                    spacing: Styles.spacing-sm;
                    alignment: space-between;
                    
                    Text {
                        text: root.name;
                        font-size: Fonts.size-lg;
                        font-weight: Fonts.weight-semibold;
                        color: Colors.text-primary;
                        overflow: elide;
                    }
                    
                    // Status badges
                    HorizontalLayout {
                        spacing: Styles.spacing-xs;
                        
                        if root.active: Rectangle {
                            background: Colors.success;
                            border-radius: Styles.radius-full;
                            padding-left: Styles.spacing-sm;
                            padding-right: Styles.spacing-sm;
                            padding-top: 2px;
                            padding-bottom: 2px;
                            
                            Text {
                                text: "Active";
                                font-size: Fonts.size-xs;
                                color: Colors.text-on-primary;
                                font-weight: Fonts.weight-medium;
                            }
                        }
                        
                        if !root.is-enabled: Rectangle {
                            background: Colors.text-disabled;
                            border-radius: Styles.radius-full;
                            padding-left: Styles.spacing-sm;
                            padding-right: Styles.spacing-sm;
                            padding-top: 2px;
                            padding-bottom: 2px;
                            
                            Text {
                                text: "Disabled";
                                font-size: Fonts.size-xs;
                                color: Colors.text-on-primary;
                                font-weight: Fonts.weight-medium;
                            }
                        }
                    }
                }
                
                // Description
                Rectangle {
                    vertical-stretch: 0;
                    max-height: 60px;
                    clip: true;
                    
                    Text {
                        text: root.description;
                        font-size: Fonts.size-sm;
                        color: Colors.text-secondary;
                        wrap: word-wrap;
                        width: 100%;
                    }
                }
                
                // Hotkey
                if root.hotkey != "": HorizontalLayout {
                    spacing: Styles.spacing-xs;
                    
                    Text {
                        text: "Hotkey:";
                        font-size: Fonts.size-sm;
                        color: Colors.text-secondary;
                    }
                    
                    Text {
                        text: root.hotkey;
                        font-size: Fonts.size-sm;
                        color: Colors.primary;
                        font-weight: Fonts.weight-medium;
                    }
                }
            }
            
            // Action buttons
            VerticalLayout {
                spacing: Styles.spacing-xs;
                alignment: center;
                
                if !root.active: TouchArea {
                    width: 80px;
                    height: 28px;
                    
                    clicked => { root.activate-requested(); }
                    
                    Rectangle {
                        background: parent.has-hover ? Colors.primary-dark : Colors.primary;
                        border-radius: Styles.radius-sm;
                        
                        animate background { duration: Styles.transition-fast; }
                        
                        Text {
                            text: "Activate";
                            font-size: Fonts.size-sm;
                            color: Colors.text-on-primary;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                }
            }
        }
    }
}